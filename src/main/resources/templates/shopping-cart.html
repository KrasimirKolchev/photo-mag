<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>SHOPPING CART</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/img/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
    <link rel="manifest" href="/img/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/img/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<body>

<nav th:include="~{fragments/menu}" class="navbar navbar-expand-lg navbar-dark fixed-top"></nav>

<div class="bg">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <h2 class="text-center text-white">Shopping Cart</h2>
            </div>
        </div>

        <th:block th:if="${#lists.isEmpty(shoppingCart.items)}">
            <div class="row">
                <div class="col-sm-12">
                    <h3 class=" text-white text-center">Your shopping cart is empty</h3>
                </div>
            </div>
        </th:block>


            <div class="container shopping-cart" th:object="${shoppingCart}">
                <div class="shopping-cart cart-head">
                    <div class="row">
                        <div class="col-sm-2">
                            Product Image
                        </div>
                        <div class="col-sm-6">
                            Product Name
                        </div>
                        <div class="col-sm-1">
                            Product quantity
                        </div>
                        <div class="col-sm-1">
                            Product price
                        </div>
                    </div>
                </div>
                <div class="shopping-cart cart-body" th:each="item : *{items}">
                    <div class="row cart-item">
                        <div class="col-sm-2">
                            <img th:src="${item.item.mainPhoto}" class="img-thumbnail" alt="Product img">
                        </div>
                        <div class="col-sm-6">
                            <p th:text="${item.item.name}">
                        </div>
                        <div class="col-sm-1">
                            <p th:text="${item.quantity}">
                        </div>
                        <div class="col-sm-1">
                            <p th:text="${item.subTotal}">
                        </div>
                        <div class="col-sm-2">
                            <div class="btn btn-danger btn-md">
                                <a type="submit" th:href="@{shopping-cart/remove(id=${item.id})}"
                                   class="text-white">Remove</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row justify-content-end">

                <th:block th:unless="${#lists.isEmpty(shoppingCart.items)}">
                    <form action='/shopping-cart/charge' method='POST' id='checkout-form'
                          th:object="${orderAddBindingModel}">
                        <input type='hidden' th:value='${amount}' name='amount'/>
                        <input type="hidden" th:field="*{orderItems}" th:value="${shoppingCart.items}"
                               th:name="orderItems"/>
                        <input type="hidden" th:field="*{totalAmount}" th:value="${shoppingCart.totalCartAmount}"
                               th:name="totalAmount"/>
                        <label>Price:<span th:text='|${amount/100} &euro;|'></span></label>
                        <!-- NOTE: data-key/data-amount/data-currency will be rendered by Thymeleaf -->
                        <script
                                src='https://checkout.stripe.com/checkout.js'
                                class='stripe-button'
                                th:attr='data-key=${stripePublicKey}, data-amount=${amount}, data-currency=${currency}'
                                data-name='Photo Mag'
                                data-description='Spring course checkout'
                                data-image
                                        ='https://www.baeldung.com/wp-content/themes/baeldung/favicon/android-chrome-192x192.png'
                                data-locale='auto'
                                data-zip-code='false'>
                        </script>
                    </form>
                </th:block>

            </div>

    </div>
</div>

</body>
</html>


